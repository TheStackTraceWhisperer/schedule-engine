# JaCoCo Code Coverage Configuration

## Overview

JaCoCo (Java Code Coverage) has been added to your Maven project to generate code coverage reports from your tests.

## What Was Configured

### 1. Properties Added (pom.xml)

```xml
<properties>
    <jacoco.version>0.8.12</jacoco.version>
    <sonar.coverage.jacoco.xmlReportPaths>${project.build.directory}/site/jacoco/jacoco.xml</sonar.coverage.jacoco.xmlReportPaths>
</properties>
```

### 2. JaCoCo Maven Plugin

The plugin was added to the `<build><plugins>` section with the following executions:

- **prepare-agent**: Prepares the JaCoCo agent before unit tests run
- **report**: Generates HTML and XML coverage reports after unit tests  
- **prepare-agent-integration**: Prepares agent for integration tests
- **report-integration**: Generates reports after integration tests
- **merge-results**: Merges unit and integration test coverage data
- **report-aggregate**: Creates an aggregate coverage report
- **check**: Validates coverage thresholds (currently set to 0% - you can increase this)

### 3. Updated Surefire & Failsafe Plugins

Both plugins were updated to include `@{argLine}` which allows JaCoCo to inject its Java agent:

```xml
<argLine>@{argLine}
    --add-modules javafx.graphics,javafx.base
    ...
</argLine>
```

## Generated Reports

When you run tests with JaCoCo, the following reports are generated:

### Unit Test Coverage
- **Location**: `target/site/jacoco-ut/index.html`
- **Data File**: `target/jacoco-ut.exec`

### Integration Test Coverage  
- **Location**: `target/site/jacoco-it/index.html`
- **Data File**: `target/jacoco-it.exec`

### Merged Coverage (Unit + Integration)
- **Location**: `target/site/jacoco/index.html`
- **Data File**: `target/jacoco.exec`

## How to Generate Reports

### Generate Unit Test Coverage
```bash
mvn clean test
```

### Generate All Coverage (Unit + Integration)
```bash
mvn clean verify
```

### View HTML Reports
```bash
# After running tests, open in browser:
# Unit test coverage:
xdg-open target/site/jacoco-ut/index.html

# Integration test coverage:
xdg-open target/site/jacoco-it/index.html

# Merged coverage (unit + integration):
xdg-open target/site/jacoco/index.html
```

### Generate Reports Only (after tests)
```bash
mvn jacoco:report
```

## Coverage Thresholds

The configuration includes coverage checks in the `verify` phase. Currently set to 0% minimum:

```xml
<limit>
    <counter>LINE</counter>
    <value>COVEREDRATIO</value>
    <minimum>0.00</minimum>  <!-- Change to 0.50 for 50%, 0.80 for 80%, etc. -->
</limit>
```

To enforce coverage requirements, increase the minimum values (0.00 to 1.00 scale).

## Integration with CI/CD

The XML reports generated by JaCoCo can be consumed by:
- **SonarQube/SonarCloud**: For code quality analysis
- **Codecov**: For coverage tracking
- **Coveralls**: For coverage reports
- **GitHub Actions**: For PR comments with coverage changes

## Troubleshooting

If JaCoCo reports are not generated:

1. **Check that tests ran**:
   ```bash
   ls -la target/test-classes/
   ```

2. **Verify JaCoCo data file exists**:
   ```bash
   ls -la target/*.exec
   ```

3. **Run with debug output**:
   ```bash
   mvn clean test -X | grep jacoco
   ```

4. **Manually trigger report generation**:
   ```bash
   mvn jacoco:report
   ```

## Next Steps

1. Run `mvn clean verify` to generate your first coverage report
2. Open `target/site/jacoco/index.html` to view merged coverage
3. Adjust coverage thresholds in pom.xml as needed
4. Integrate with your CI/CD pipeline for automatic coverage tracking

## Current Test Coverage

With your 64 passing TestFX tests, you should see coverage for:
- All View classes (SeasonView, FieldView, LeagueView, etc.)
- View initialization code
- Button and UI component creation
- Service method calls from views

Note: UI interaction code may show lower coverage as TestFX tests focus on component existence rather than full user workflows.

